<!-- 
  PROYECTO: BANTT√ö by SV
  VERSI√ìN: 1.0 (Producci√≥n)
  DESARROLLADOR: Nexor - Tecnology Systems
-->
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="BANTT√ö by SV - Calzado femenino elegante, minimalista y moderno. Dise√±os exclusivos para la mujer actual.">
    <meta property="og:title" content="BANTT√ö by SV | Elegancia que camina contigo">
    <meta property="og:description" content="Descubre nuestra nueva colecci√≥n de zapatos femeninos. Elegancia y comodidad en cada paso.">
    <meta property="og:image" content="https://images.unsplash.com/photo-1515347619252-60a6bf4fffce?q=80&w=1200">
    <meta property="og:type" content="website">
    <title>BANTT√ö by SV | Elegancia que camina contigo</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üë†</text></svg>">
    
    <!-- Google Analytics (GA4) - Descomentar y poner ID real cuando se tenga
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-TU_ID_AQUI"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-TU_ID_AQUI');
    </script>
    -->

    <!-- Fuentes de Google -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500&family=Playfair+Display:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    
    <!-- Iconos (FontAwesome CDN para prototipos) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- FIREBASE (Base de Datos en la Nube) -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

    <style>
        /* --- VARIABLES CSS & RESET --- */
        :root {
            --color-nude: #EBD5CC;
            --color-sand: #FAF7F5;
            --color-white: #FFFFFF;
            --color-black: #1C1C1C;
            --color-accent: #EFD0DB;
            --color-gray-light: #FAFAFA;
            
            --font-serif: 'Playfair Display', serif;
            --font-sans: 'Montserrat', sans-serif;
            
            --transition: all 0.3s ease;
            --shadow-soft: 0 10px 30px rgba(0,0,0,0.05);
            --shadow-hover: 0 15px 40px rgba(0,0,0,0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        html { scroll-behavior: smooth; }

        body {
            font-family: var(--font-sans);
            background-color: var(--color-sand);
            color: var(--color-black);
            line-height: 1.6;
            overflow-x: hidden;
        }

        a { text-decoration: none; color: inherit; transition: var(--transition); }
        ul { list-style: none; }
        img { max-width: 100%; display: block; }

        /* Accesibilidad: Focus visible */
        :focus-visible {
            outline: 2px solid var(--color-accent);
            outline-offset: 4px;
        }

        /* --- UTILIDADES --- */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .section-padding {
            padding: 5rem 0;
        }

        .text-center { text-align: center; }
        
        .btn {
            display: inline-block;
            padding: 12px 30px;
            font-family: var(--font-sans);
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 0.85rem;
            border: 1px solid transparent;
            cursor: pointer;
            transition: var(--transition);
        }

        .btn-primary {
            background-color: var(--color-black);
            color: var(--color-white);
        }

        .btn-primary:hover {
            background-color: var(--color-accent);
            border-color: var(--color-accent);
            color: var(--color-white);
        }

        .btn-outline {
            border: 1px solid var(--color-black);
            color: var(--color-black);
            background: transparent;
        }

        .btn-outline:hover {
            background-color: var(--color-black);
            color: var(--color-white);
        }

        .btn-light {
            background-color: var(--color-white);
            color: var(--color-black);
        }
        .btn-light:hover {
            background-color: var(--color-accent);
            border-color: var(--color-accent);
            color: var(--color-white);
        }

        h1, h2, h3 {
            font-family: var(--font-serif);
            font-weight: 400;
        }

        /* --- HEADER --- */
        header {
            position: fixed;
            top: 0;
            width: 100%;
            background-color: rgba(250, 247, 245, 0.95);
            backdrop-filter: blur(10px);
            z-index: 1000;
            box-shadow: 0 2px 20px rgba(0,0,0,0.03);
            padding: 15px 0;
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-family: var(--font-serif);
            font-size: 1.5rem;
            font-weight: 600;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo span { color: var(--color-accent); }

        .nav-links {
            display: flex;
            gap: 30px;
        }

        .nav-links a {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
        }

        .nav-links a::after {
            content: '';
            position: absolute;
            width: 0;
            height: 1px;
            bottom: -5px;
            left: 0;
            background-color: var(--color-accent);
            transition: var(--transition);
        }

        .nav-links a:hover::after { width: 100%; }

        .nav-icons {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .whatsapp-btn {
            color: var(--color-black);
            font-size: 1.2rem;
        }
        .whatsapp-btn:hover { color: #25D366; }

        .mobile-toggle { display: none; font-size: 1.5rem; cursor: pointer; }

        /* --- CARRITO & MODAL (NUEVO) --- */
        .cart-icon-wrap { position: relative; cursor: pointer; margin-right: 10px; }
        .cart-count { position: absolute; top: -8px; right: -8px; background: var(--color-black); color: var(--color-white); font-size: 0.7rem; width: 18px; height: 18px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; }
        
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1500; opacity: 0; visibility: hidden; transition: var(--transition); }
        .overlay.active { opacity: 1; visibility: visible; }

        .cart-sidebar { position: fixed; top: 0; right: 0; width: 100%; max-width: 400px; height: 100vh; background: var(--color-white); z-index: 2000; transform: translateX(100%); transition: transform 0.4s cubic-bezier(0.77, 0, 0.175, 1); box-shadow: -5px 0 30px rgba(0,0,0,0.1); display: flex; flex-direction: column; }
        .cart-sidebar.active { transform: translateX(0); }
        
        .cart-header { padding: 20px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; }
        .cart-items { flex: 1; overflow-y: auto; padding: 20px; }
        .cart-item { display: flex; gap: 15px; margin-bottom: 20px; animation: fadeIn 0.3s ease; }
        .cart-item img { width: 70px; height: 70px; object-fit: cover; border-radius: 4px; }
        .cart-item-details { flex: 1; }
        .cart-item-remove { color: #999; cursor: pointer; font-size: 0.8rem; text-decoration: underline; }
        
        .cart-footer { padding: 25px; border-top: 1px solid #eee; background: #f9f9f9; }
        .cart-total { display: flex; justify-content: space-between; font-size: 1.2rem; font-weight: 600; margin-bottom: 20px; font-family: var(--font-serif); }

        /* Modal Checkout */
        .modal { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.9); width: 90%; max-width: 500px; background: white; z-index: 2500; padding: 30px; border-radius: 8px; opacity: 0; visibility: hidden; transition: all 0.3s; box-shadow: 0 20px 60px rgba(0,0,0,0.2); }
        .modal.active { opacity: 1; visibility: visible; transform: translate(-50%, -50%) scale(1); }
        
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; font-size: 0.85rem; font-weight: 500; }
        .form-group input { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 4px; font-family: inherit; transition: var(--transition); }
        .form-group input:focus { border-color: var(--color-black); outline: none; }
        .row { display: flex; gap: 15px; }
        
        .btn-block { display: block; width: 100%; text-align: center; margin-bottom: 10px; }
        .btn-whatsapp { background-color: #25D366; color: white; border: none; }
        .btn-whatsapp:hover { background-color: #128C7E; color: white; }

        /* Payment Methods */
        .payment-methods { display: flex; gap: 10px; margin-bottom: 20px; }
        .payment-method-label { flex: 1; border: 1px solid #ddd; padding: 10px; text-align: center; border-radius: 4px; cursor: pointer; font-size: 0.8rem; transition: var(--transition); display: flex; flex-direction: column; align-items: center; gap: 5px; }
        .payment-method-label:hover { background: #f9f9f9; }
        .payment-method-input { display: none; }
        .payment-method-input:checked + .payment-method-label { border-color: var(--color-black); background: var(--color-black); color: var(--color-white); }
        .payment-details { display: none; animation: fadeIn 0.3s ease; }
        .payment-details.active { display: block; }

        .qr-code-img {
            display: block;
            margin: 0 auto 15px;
            border: 5px solid white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-radius: 8px;
            max-width: 160px;
        }

        /* Spinner Loader */
        .loader { border: 3px solid #f3f3f3; border-top: 3px solid var(--color-accent); border-radius: 50%; width: 20px; height: 20px; animation: spin 1s linear infinite; display: inline-block; margin-right: 10px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* Toast Notification */
        .toast {
            visibility: hidden;
            min-width: 250px;
            background-color: var(--color-black);
            color: var(--color-white);
            text-align: center;
            border-radius: 4px;
            padding: 16px;
            position: fixed;
            z-index: 3000;
            left: 50%;
            bottom: 30px;
            transform: translateX(-50%);
            font-size: 0.9rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            opacity: 0;
            transition: opacity 0.3s, bottom 0.3s;
        }
        .toast.show {
            visibility: visible;
            opacity: 1;
            bottom: 50px;
        }

        /* Add to cart btn inside card */
        .add-to-cart-btn { margin-top: 10px; font-size: 0.8rem; padding: 8px 20px; background: var(--color-black); color: white; border: none; cursor: pointer; opacity: 0; transform: translateY(10px); transition: var(--transition); }
        .product-card:hover .add-to-cart-btn { opacity: 1; transform: translateY(0); }

        /* --- ADMIN PANEL --- */
        .admin-trigger { cursor: pointer; opacity: 0.3; transition: 0.3s; margin-left: 10px; }
        .admin-trigger:hover { opacity: 1; color: var(--color-accent); }
        .admin-dashboard { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 3000; padding: 20px; overflow-y: auto; display: none; }
        .admin-dashboard.active { display: block; }
        .admin-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; border-bottom: 1px solid #eee; padding-bottom: 15px; }
        .product-list-item { display: flex; align-items: center; gap: 15px; padding: 15px; border-bottom: 1px solid #eee; }
        .product-list-item img { width: 50px; height: 50px; object-fit: cover; border-radius: 4px; }
        .product-list-info { flex: 1; }
        .admin-actions { display: flex; gap: 10px; }
        .btn-sm { padding: 5px 10px; font-size: 0.7rem; }
        .btn-danger { background-color: #ff4444; color: white; border: none; }
        .edit-form { background: #f9f9f9; padding: 20px; border-radius: 8px; margin-bottom: 20px; display: none; }
        .edit-form.active { display: block; }
        .sizes-grid { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 5px; }
        
        .stock-color-group {
            border: 1px solid #eee;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 4px;
        }
        .size-stock-item {
            display: flex;
            align-items: center;
            gap: 10px;
            background: white;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .size-stock-item label {
            margin-bottom: 0;
            font-weight: normal;
        }
        .size-stock-item input {
            width: 60px;
            padding: 5px;
        }
        /* Admin Image Grid */
        .current-images-grid { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 10px; }
        .image-preview-item { position: relative; width: 80px; height: 80px; border: 1px solid #ddd; border-radius: 4px; overflow: hidden; }
        .image-preview-item img { width: 100%; height: 100%; object-fit: cover; }
        .image-preview-item .remove-btn { position: absolute; top: 0; right: 0; background: rgba(255,0,0,0.8); color: white; border: none; width: 20px; height: 20px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 12px; }
        
        .product-card.out-of-stock .product-image img {
            filter: grayscale(80%);
        }
        .product-card.out-of-stock .product-image img {
            filter: grayscale(80%);
        }
        .product-card.out-of-stock .add-to-cart-btn {
            background-color: #999;
            cursor: not-allowed;
        }
        .product-image .sold-out-badge {
            position: absolute;
            top: 15px;
            left: 15px;
            background: var(--color-black);
            color: var(--color-white);
            padding: 5px 10px;
            font-size: 0.8rem;
            border-radius: 4px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Scroll to Top */
        .scroll-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background-color: var(--color-black);
            color: var(--color-white);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
            z-index: 900;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        .scroll-top.active {
            opacity: 1;
            visibility: visible;
        }
        .scroll-top:hover {
            background-color: var(--color-accent);
            transform: translateY(-3px);
        }

        /* --- HERO SECTION --- */
        .hero {
            height: 90vh;
            /* Capas: 1. Sombra, 2. Logo, 3. Degradado de fondo (Negro a Rosado) */
            background-image: 
                linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), 
                url('logo.jpeg'),
                linear-gradient(to bottom, var(--color-black), var(--color-accent));
            background-size: cover, contain, cover;
            background-repeat: no-repeat;
            background-position: center;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: var(--color-white);
            margin-top: 60px; /* Offset header */
        }

        .hero-content {
            max-width: 800px;
            padding: 20px;
            animation: fadeIn Up 1s ease-out;
        }

        .hero h1 {
            font-size: 3.5rem;
            margin-bottom: 1rem;
            line-height: 1.2;
        }

        .hero p {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            font-weight: 300;
            letter-spacing: 1px;
        }

        /* --- COLLECTION --- */
        .section-title {
            text-align: center;
            margin-bottom: 3rem;
        }

        .section-title h2 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .section-title span {
            display: block;
            width: 50px;
            height: 2px;
            background-color: var(--color-accent);
            margin: 0 auto;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 40px;
        }

        .product-card {
            background: var(--color-white);
            transition: var(--transition);
            position: relative;
        }

        .product-card:hover {
            transform: translateY(-5px);
        }

        .product-image {
            position: relative;
            overflow: hidden;
            aspect-ratio: 1/1; /* Cuadrado para mejor galer√≠a */
            background-color: #eee;
        }

        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: opacity 0.3s ease;
        }

        /* Galer√≠a simple */
        .gallery-nav {
            position: absolute;
            bottom: 10px;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: center;
            gap: 5px;
            z-index: 2;
        }
        .gallery-dot {
            width: 8px;
            height: 8px;
            background: rgba(255,255,255,0.5);
            border-radius: 50%;
            cursor: pointer;
        }
        .gallery-dot.active { background: var(--color-black); }

        /* Filtros de Categor√≠a */
        .category-filters {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 30px;
        }
        .filter-btn {
            padding: 8px 16px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: var(--transition);
        }
        .filter-btn.active, .filter-btn:hover {
            background: var(--color-black);
            color: white;
            border-color: var(--color-black);
        }

        .product-info {
            padding: 20px 0;
            text-align: center;
        }

        .product-name {
            font-family: var(--font-serif);
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        .product-price {
            color: var(--color-accent);
            font-weight: 500;
            font-size: 1rem;
        }
        
        .color-select-wrap {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 10px 0;
        }
        .color-option {
            cursor: pointer;
            border: 1px solid #ddd;
            padding: 5px 10px;
            font-size: 0.8rem;
            border-radius: 4px;
        }
        .color-option.selected {
            background-color: var(--color-black);
            color: white;
            border-color: var(--color-black);
        }

        .size-select {
            margin: 10px 0;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: var(--font-sans);
            background-color: white;
            cursor: pointer;
        }

        /* --- IDENTITY --- */
        .identity {
            background-color: var(--color-nude);
            color: var(--color-black);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .identity-content {
            max-width: 700px;
            text-align: center;
        }

        .identity h2 {
            font-size: 2.5rem;
            margin-bottom: 1.5rem;
        }

        .identity p {
            font-size: 1.1rem;
            margin-bottom: 2rem;
        }

        /* --- BENEFITS --- */
        .benefits-grid {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 30px;
            text-align: center;
        }

        .benefit-item {
            flex: 1;
            min-width: 250px;
            padding: 20px;
        }

        .benefit-icon {
            font-size: 2.5rem;
            color: var(--color-accent);
            margin-bottom: 20px;
        }

        .benefit-item h3 {
            font-size: 1.2rem;
            margin-bottom: 10px;
            font-family: var(--font-sans);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .benefit-item p {
            font-size: 0.9rem;
            color: #555;
        }

        /* --- CTA --- */
        .cta {
            background-color: var(--color-white);
            text-align: center;
        }

        .cta h2 {
            margin-bottom: 1rem;
        }

        /* --- FOOTER --- */
        footer {
            background-color: var(--color-black);
            color: var(--color-white);
            padding: 4rem 0 2rem;
            text-align: center;
        }

        .footer-logo {
            font-family: var(--font-serif);
            font-size: 1.8rem;
            margin-bottom: 20px;
            display: inline-block;
        }

        .social-links {
            margin-bottom: 30px;
        }

        .social-links a {
            color: var(--color-white);
            font-size: 1.2rem;
            margin: 0 10px;
            transition: var(--transition);
        }

        .social-links a:hover {
            color: var(--color-accent);
        }

        .copyright {
            font-size: 0.8rem;
            color: #888;
            border-top: 1px solid #333;
            padding-top: 20px;
        }

        /* --- ANIMATIONS --- */
        .reveal {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s ease;
        }

        .reveal.active {
            opacity: 1;
            transform: translateY(0);
        }

        /* --- RESPONSIVE --- */
        @media (max-width: 768px) {
            .hero h1 { font-size: 2.5rem; }
            
            .mobile-toggle { display: block; }
            
            .nav-links {
                position: fixed;
                top: 70px;
                left: 0;
                width: 100%;
                background-color: var(--color-white);
                flex-direction: column;
                align-items: center;
                padding: 40px 0;
                gap: 20px;
                transform: translateY(-150%);
                transition: transform 0.4s ease;
                box-shadow: 0 10px 20px rgba(0,0,0,0.05);
            }

            .nav-links.active {
                transform: translateY(0);
            }
        }
    </style>
</head>
<body>

    <!-- HEADER -->
    <header>
        <div class="container">
            <nav>
                <a href="#" class="logo">BANTT√ö <span>by SV</span></a>
                
                <ul class="nav-links" id="navLinks">
                    <li><a href="#hero">Inicio</a></li>
                    <li><a href="#collection">Colecci√≥n</a></li>
                    <li><a href="#identity">Sobre Nosotros</a></li>
                    <li><a href="#cta">Contacto</a></li>
                </ul>

                <div class="nav-icons">
                    <div class="cart-icon-wrap" onclick="openCart()" role="button" aria-label="Abrir carrito" tabindex="0">
                        <i class="fas fa-shopping-bag"></i>
                        <span class="cart-count" id="cartCount">0</span>
                    </div>
                    <a href="https://wa.me/573157243588" target="_blank" class="whatsapp-btn" aria-label="Contactar por WhatsApp"><i class="fab fa-whatsapp"></i></a>
                    <div class="mobile-toggle" id="mobileToggle">
                        <i class="fas fa-bars"></i>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <!-- HERO -->
    <section id="hero" class="hero">
        <div class="hero-content">
            <h1>Elegancia que camina contigo</h1>
            <p>Dise√±os exclusivos pensados para la mujer moderna que no renuncia a la comodidad.</p>
            <a href="#collection" class="btn btn-light">Ver Colecci√≥n</a>
        </div>
    </section>

    <!-- COLECCI√ìN -->
    <section id="collection" class="section-padding container">
        <div class="section-title reveal">
            <h2>Nueva Colecci√≥n</h2>
            <span></span>
        </div>

        <div class="category-filters" id="categoryFilters">
            <button class="filter-btn active" onclick="filterProducts('all')">Todos</button>
            <button class="filter-btn" onclick="filterProducts('sandalias')">Sandalias</button>
            <button class="filter-btn" onclick="filterProducts('tacones')">Tacones</button>
            <button class="filter-btn" onclick="filterProducts('baletas')">Baletas</button>
            <button class="filter-btn" onclick="filterProducts('stilettos')">Stilettos</button>
            <button class="filter-btn" onclick="filterProducts('tenis')">Tenis</button>
        </div>

        <div class="products-grid">
            <!-- Productos cargados din√°micamente -->
        </div>
    </section>

    <!-- IDENTIDAD DE MARCA -->
    <section id="identity" class="section-padding identity reveal">
        <div class="container identity-content">
            <h2>M√°s que zapatos, una declaraci√≥n</h2>
            <p>En BANTT√ö by SV creemos que el calzado es la base de la confianza. Cada par es dise√±ado meticulosamente combinando la artesan√≠a tradicional con las tendencias contempor√°neas, utilizando materiales que abrazan tus pies.</p>
            <a href="#" class="btn btn-outline" style="pointer-events: none; opacity: 0.6;">Nuestra Historia</a>
        </div>
    </section>

    <!-- BENEFICIOS -->
    <section id="benefits" class="section-padding container reveal">
        <div class="benefits-grid">
            <div class="benefit-item">
                <i class="fas fa-crown benefit-icon"></i>
                <h3>Dise√±o Exclusivo</h3>
                <p>Piezas √∫nicas creadas para resaltar tu personalidad.</p>
            </div>
            <div class="benefit-item">
                <i class="fas fa-feather-alt benefit-icon"></i>
                <h3>Comodidad Absoluta</h3>
                <p>Plantillas ergon√≥micas para usar todo el d√≠a.</p>
            </div>
            <div class="benefit-item">
                <i class="fas fa-gem benefit-icon"></i>
                <h3>Calidad Premium</h3>
                <p>Materiales seleccionados para durar en el tiempo.</p>
            </div>
        </div>
    </section>

    <!-- CALL TO ACTION -->
    <section id="cta" class="section-padding cta reveal">
        <div class="container">
            <h2>¬øLista para dar el siguiente paso?</h2>
            <p style="margin-bottom: 2rem;">Recibe asesor√≠a personalizada y compra directamente.</p>
            <a href="https://wa.me/573157243588?text=Hola%20BANTT√ö,%20necesito%20asesor√≠a%20sobre%20sus%20productos." target="_blank" class="btn btn-primary">
                <i class="fab fa-whatsapp" style="margin-right: 8px;"></i> Comprar por WhatsApp
            </a>
        </div>
    </section>

    <!-- FOOTER -->
    <footer>
        <div class="container">
            <a href="#" class="footer-logo">BANTT√ö by SV</a>
            <div class="social-links">
                <a href="https://www.instagram.com/banttu_by.sv?igsh=MXJjOXV6eDU1d2dr&utm_source=qr" target="_blank"><i class="fab fa-instagram"></i></a>
        <a href="https://www.tiktok.com/@banttu_?_r=1&_t=ZS-93PLmdbwyKP" target="_blank"><i class="fab fa-tiktok"></i></a>
                <a href="https://www.facebook.com/people/Banttu-Store/61585272604769/?mibextid=wwXIfr&rdid=pLANRVhOtd5XGY2c&share_url=https%3A%2F%2Fwww.facebook.com%2Fshare%2F1BE27Dw6gj%2F%3Fmibextid%3DwwXIfr"  target="_blank"><i class="fab fa-facebook-f"></i></a>
            </div>
            <div class="copyright">
                <p>&copy; 2026 BANTT√ö by SV. Todos los derechos reservados.</p>
            <p style="font-size: 0.7rem; margin-top: 5px; opacity: 0.6;"><a href="https://nexor-tecnology-systems.netlify.app/" target="_blank" style="color: inherit; text-decoration: none;">Desarrollado por Nexor - Tecnology Systems</a></p>
                <i class="fas fa-lock admin-trigger" onclick="openAdminLogin()" title="Acceso Administrativo"></i>
            </div>
        </div>
    </footer>

    <!-- ELEMENTOS FLOTANTES (CARRITO Y MODAL) -->
    <div class="overlay" id="overlay" onclick="closeCart(); closeModal()"></div>

    <!-- Sidebar Carrito -->
    <div class="cart-sidebar" id="cartSidebar">
        <div class="cart-header">
            <h3>Tu Bolsa de Compras</h3>
            <i class="fas fa-times" style="cursor: pointer;" onclick="closeCart()" role="button" aria-label="Cerrar carrito" tabindex="0"></i>
        </div>
        <div class="cart-items" id="cartItems">
            <!-- Items inyectados por JS -->
            <p class="text-center" style="margin-top: 50px; color: #999;">Tu carrito est√° vac√≠o.</p>
        </div>
        <div class="cart-footer">
            <div class="cart-total">
                <span>Total</span>
                <span id="cartTotal">$0.00</span>
            </div>
            <button class="btn btn-primary btn-block" onclick="openCheckout()">Proceder al Pago</button>
            <button class="btn btn-outline btn-block" onclick="closeCart()">Seguir Comprando</button>
        </div>
    </div>

    <!-- Modal Checkout -->
    <div class="modal" id="checkoutModal">
        <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
            <h3>Finalizar Compra</h3>
            <i class="fas fa-times" style="cursor: pointer;" onclick="closeModal()" role="button" aria-label="Cerrar modal" tabindex="0"></i>
        </div>
        
        <div class="payment-methods">
            <input type="radio" name="paymentMethod" id="pm-nequi" class="payment-method-input" checked onchange="togglePaymentMethod('nequi')">
            <label for="pm-nequi" class="payment-method-label"><i class="fas fa-mobile-alt"></i> Nequi</label>

            <input type="radio" name="paymentMethod" id="pm-cash" class="payment-method-input" onchange="togglePaymentMethod('cash')">
            <label for="pm-cash" class="payment-method-label"><i class="fas fa-truck"></i> Contra Entrega</label>
        </div>

        <form id="paymentForm" onsubmit="processPayment(event)">
            <div class="form-group">
                <label>Nombre Completo</label>
                <input type="text" id="customerName" required placeholder="Ej. Mar√≠a P√©rez">
            </div>
            <div class="form-group">
                <label>Direcci√≥n de Env√≠o</label>
                <input type="text" id="customerAddress" required placeholder="Calle 123 # 45-67, Ciudad">
            </div>

            <!-- Nequi Details -->
            <div id="details-nequi" class="payment-details active">
                <div class="text-center">
                    <p style="font-size: 0.9rem; margin-bottom: 15px;">Escanea este c√≥digo QR con tu app Nequi para pagar.</p>
                    <img src="https://api.qrserver.com/v1/create-qr-code/?size=160x160&data=tel:573157243588" alt="C√≥digo QR Nequi" class="qr-code-img">
                    <p style="font-size: 0.8rem; color: #666;">O env√≠a al n√∫mero: <strong>315 724 3588</strong></p>
                </div>
                <div class="form-group">
                    <label style="margin-top: 15px;">Tu N√∫mero de Celular (Para confirmar)</label>
                    <input type="text" id="nequiPhoneNumber" placeholder="300 000 0000">
                </div>
                <div class="form-group">
                    <label>Subir Comprobante (Opcional)</label>
                    <input type="file" id="nequiReceipt" accept="image/*">
                    <p style="font-size: 0.7rem; color: #666; margin-top: 5px;">* La imagen debes adjuntarla en el chat de WhatsApp al finalizar.</p>
                </div>
            </div>

            <!-- Cash Details -->
            <div id="details-cash" class="payment-details">
                <p style="font-size: 0.9rem; color: #555; margin-bottom: 15px; text-align: center; border: 1px dashed #ccc; padding: 10px;">
                    <i class="fas fa-info-circle"></i> Pagar√°s en efectivo al repartidor.
                </p>
            </div>

            <button type="submit" class="btn btn-primary btn-block" id="payBtn">Confirmar Pedido</button>
        </form>
        
        <div style="text-align: center; margin: 15px 0; font-size: 0.8rem; color: #888;">O prefiere un trato personal:</div>
        
        <button class="btn btn-whatsapp btn-block" onclick="checkoutWhatsApp()">
            <i class="fab fa-whatsapp"></i> Enviar Pedido por WhatsApp
        </button>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <!-- Scroll to Top -->
    <div class="scroll-top" onclick="scrollToTop()">
        <i class="fas fa-arrow-up"></i>
    </div>

    <!-- ADMIN LOGIN MODAL -->
    <div class="modal" id="adminLoginModal">
        <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
            <h3>Acceso Administrativo</h3>
            <i class="fas fa-times" style="cursor: pointer;" onclick="closeAdminLogin()"></i>
        </div>
        <div class="form-group">
            <label>Contrase√±a</label>
            <input type="password" id="adminPassword" placeholder="Ingrese contrase√±a">
        </div>
        <button class="btn btn-primary btn-block" onclick="checkAdminLogin()">Ingresar</button>
    </div>

    <!-- ADMIN DASHBOARD -->
    <div class="admin-dashboard" id="adminDashboard">
        <div class="container">
            <div class="admin-header">
                <h2>Gesti√≥n de Inventario</h2>
                <div style="display: flex; gap: 10px;">
                    <button class="btn btn-outline" onclick="downloadBackup()"><i class="fas fa-download"></i> Backup</button>
                    <button class="btn btn-outline" onclick="exportForCode()"><i class="fas fa-code"></i> Copiar C√≥digo</button>
                    <button class="btn btn-outline" onclick="triggerRestore()"><i class="fas fa-upload"></i> Restaurar</button>
                    <button class="btn btn-outline" onclick="toggleHelp()"><i class="fas fa-question-circle"></i> Ayuda</button>                    
                    <button class="btn btn-outline" onclick="togglePasswordChange()"><i class="fas fa-key"></i> Clave</button>
                    <button class="btn btn-outline" onclick="closeAdminDashboard()">Cerrar Sesi√≥n</button>
                </div>
            </div>

            <!-- Input oculto para restaurar backup -->
            <input type="file" id="restoreInput" accept=".json" style="display:none" onchange="restoreBackup(this)">

            <div class="edit-form" id="passwordChangeForm">
                <h3>Cambiar Contrase√±a</h3>
                <div class="form-group">
                    <label>Nueva Contrase√±a</label>
                    <input type="password" id="newAdminPass" placeholder="Ingresa la nueva clave">
                </div>
                <button class="btn btn-primary" onclick="saveNewPassword()">Actualizar</button>
                <button class="btn btn-outline" onclick="togglePasswordChange()">Cancelar</button>
            </div>

            <div class="edit-form" id="adminHelp">
                <h3><i class="fas fa-book"></i> Manual de Administraci√≥n</h3>
                <div style="font-size: 0.9rem; color: #555; line-height: 1.6; max-height: 400px; overflow-y: auto;">
                    <p style="background: #e3f2fd; color: #0d47a1; padding: 10px; border-radius: 4px; border: 1px solid #bbdefb;"><strong>‚òÅÔ∏è MODO NUBE:</strong> Si has configurado Firebase, los cambios se guardar√°n autom√°ticamente para todos los usuarios. Si no, seguir√°n guard√°ndose solo en este dispositivo.</p>
                    <p><strong>1. Acceso:</strong> Usa el candado (üîí) en el pie de p√°gina. Clave inicial: <code>admin123</code>.</p>
                    <p><strong>2. Gesti√≥n de Productos:</strong>
                        <ul style="margin-left: 20px; margin-bottom: 10px;">
                            <li><em>Crear:</em> Bot√≥n "Nuevo Producto". Llena nombre, precio y stock por talla.</li>
                            <li><em>Editar:</em> Bot√≥n (‚úèÔ∏è) en la lista. Ajusta precios o stock manualmente si vendes en f√≠sico.</li>
                            <li><em>Eliminar:</em> Bot√≥n (üóëÔ∏è). ¬°Cuidado! No se puede deshacer.</li>
                        </ul>
                    </p>
                    <p><strong>3. Im√°genes:</strong> Puedes subir fotos desde tu celular; el sistema las optimiza autom√°ticamente para que no pesen mucho.</p>
                    <p><strong>4. Pedidos:</strong> El cliente env√≠a el pedido a tu WhatsApp. El stock en la web se descuenta autom√°ticamente cuando el cliente finaliza el proceso en la p√°gina.</p>
                    <p><strong>5. Copia de Seguridad:</strong> Usa <strong>"Backup"</strong> para descargar tus datos. Usa <strong>"Restaurar"</strong> para cargar un archivo guardado anteriormente si cambias de dispositivo.</p>
                    <p><strong>6. Publicar Cambios:</strong> Tus cambios son locales. Para que el mundo los vea: Usa <strong>"Copiar C√≥digo"</strong>, pega el texto en tu archivo <code>index.html</code> (reemplazando <code>defaultProducts</code>) y sube el archivo a Netlify.</p>
                    <p style="background: #fff3cd; padding: 10px; border-radius: 4px;"><strong>‚ö†Ô∏è Importante:</strong> Los datos se guardan en este dispositivo. Evita "Borrar datos de navegaci√≥n" para no perder el inventario. ¬°Usa la funci√≥n de Backup regularmente!</p>
                </div>
                <button class="btn btn-outline" style="margin-top: 15px;" onclick="toggleHelp()">Cerrar Manual</button>
            </div>

            <div class="edit-form" id="productForm">
                <h3>Editar/Agregar Producto</h3>
                <input type="hidden" id="editId">
                <div class="form-group"><label>Nombre</label><input type="text" id="editName"></div>
                <div class="form-group">
                    <label>Categor√≠a</label>
                    <select id="editCategory" style="width:100%; padding:10px;">
                        <option value="sandalias">Sandalias</option>
                        <option value="tacones">Tacones</option>
                        <option value="baletas">Baletas</option>
                        <option value="stilettos">Stilettos</option>
                        <option value="tenis">Tenis</option>
                    </select>
                </div>
                <div class="form-group"><label>Precio</label><input type="number" id="editPrice"></div>
                
                <div class="form-group">
                    <label>Gesti√≥n de Colores y Stock</label>
                    <div style="display:flex; gap:10px; margin-bottom:10px;">
                        <input type="text" id="newColorInput" placeholder="Nombre del color (ej. Rojo)">
                        <button class="btn btn-sm btn-outline" onclick="adminAddColor()">Agregar Color</button>
                    </div>
                    <div id="stockContainer"></div>
                </div>

                <div class="form-group">
                    <label>Im√°genes Actuales (Click en X para borrar)</label>
                    <div id="currentImagesContainer" class="current-images-grid"></div>
                </div>
                <div class="form-group"><label>Agregar URLs (separadas por coma)</label><input type="text" id="editImages" placeholder="url1, url2..."></div>
                <div class="form-group"><label>Subir Nuevas Fotos (Puedes seleccionar varias)</label><input type="file" id="editImageFile" accept="image/*" multiple></div>
                
                <button class="btn btn-primary" onclick="saveProduct()">Guardar Cambios</button>
                <button class="btn btn-outline" onclick="cancelEdit()">Cancelar</button>
            </div>

            <button class="btn btn-primary" style="margin-bottom: 20px;" onclick="showAddForm()"><i class="fas fa-plus"></i> Nuevo Producto</button>
            <div id="adminProductList"></div>
        </div>
    </div>

    <!-- SCRIPTS -->
    <script>
        /* --- 1. UTILIDADES Y CONFIGURACI√ìN --- */
        
        // --- CONFIGURACI√ìN DE FIREBASE (Base de Datos) ---
        // 1. Ve a https://console.firebase.google.com/
        // 2. Crea un proyecto nuevo.
        // 3. Agrega una "App Web" (</>).
        // 4. Copia las credenciales aqu√≠ abajo:
        const firebaseConfig = {
            apiKey: "AIzaSyCCJo6QgRi2ux0D-n47vSUofO2jfrHqq1k",
            authDomain: "banttu-store.firebaseapp.com",
            projectId: "banttu-store",
            storageBucket: "banttu-store.firebasestorage.app",
            messagingSenderId: "1084587905851",
            appId: "1:1084587905851:web:eae24b6b913f8ad242dd1e",
            measurementId: "G-Q0BJELXV0Z"
        };
        // -------------------------------------------------

        // --- CONFIGURACI√ìN DE IM√ÅGENES (ImgBB) ---
        // Pega aqu√≠ tu API Key de https://api.imgbb.com/
        const IMGBB_API_KEY = "25bdea01eba12eef750cde4a5d8d13a8"; 
        // -------------------------------------------------

        let db = null; // Referencia a la base de datos

        const CONFIG = {
            WHATSAPP: '573157243588',
            STORAGE: {
                CART: 'banttu_cart',
                PRODUCTS: 'banttu_products',
                ADMIN: 'banttu_admin_pass'
            }
        };

        // Inicializar Firebase si hay configuraci√≥n
        if (firebaseConfig.apiKey && firebaseConfig.apiKey !== "TU_API_KEY_AQUI") {
            try {
                firebase.initializeApp(firebaseConfig);
                // Se conecta a la base de datos '(default)' autom√°ticamente
                db = firebase.firestore();
                console.log("Conectado a Firebase");
            } catch(e) { console.error("Error Firebase:", e); }
        }

        // Men√∫ M√≥vil
        const mobileToggle = document.getElementById('mobileToggle');
        const navLinks = document.getElementById('navLinks');

        mobileToggle.addEventListener('click', () => {
            navLinks.classList.toggle('active');
            // Cambiar icono de hamburguesa a X
            const icon = mobileToggle.querySelector('i');
            if (navLinks.classList.contains('active')) {
                icon.classList.remove('fa-bars');
                icon.classList.add('fa-times');
            } else {
                icon.classList.remove('fa-times');
                icon.classList.add('fa-bars');
            }
        });

        // Cerrar men√∫ al hacer click en un enlace
        document.querySelectorAll('.nav-links a').forEach(link => {
            link.addEventListener('click', () => {
                navLinks.classList.remove('active');
                mobileToggle.querySelector('i').classList.remove('fa-times');
                mobileToggle.querySelector('i').classList.add('fa-bars');
            });
        });

        // Animaci√≥n de Scroll (Intersection Observer)
        const revealElements = document.querySelectorAll('.reveal');

        const revealObserver = new IntersectionObserver((entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('active');
                    observer.unobserve(entry.target); // Solo animar una vez
                }
            });
        }, {
            root: null,
            threshold: 0.15, // 15% visible para activar
            rootMargin: "0px 0px -50px 0px"
        });

        revealElements.forEach(el => revealObserver.observe(el));

        // Scroll to Top Logic
        const scrollTopBtn = document.querySelector('.scroll-top');
        window.addEventListener('scroll', () => {
            if (window.pageYOffset > 300) {
                scrollTopBtn.classList.add('active');
            } else {
                scrollTopBtn.classList.remove('active');
            }
        });

        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        /* --- 2. ESTADO DE LA APLICACI√ìN (STATE) --- */
        let cart = [];
        const cartSidebar = document.getElementById('cartSidebar');
        const overlay = document.getElementById('overlay');
        const cartItemsContainer = document.getElementById('cartItems');
        const cartTotalEl = document.getElementById('cartTotal');
        const cartCountEl = document.getElementById('cartCount');
        const checkoutModal = document.getElementById('checkoutModal');

        // Formateador de moneda y Utilidades
        const formatCurrency = (amount) => new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(amount);
        const delay = (ms) => new Promise(resolve => setTimeout(resolve, ms));

        /* --- 3. L√ìGICA DEL CARRITO (CART LOGIC) --- */
        function openCart() {
            cartSidebar.classList.add('active');
            overlay.classList.add('active');
        }

        function closeCart() {
            cartSidebar.classList.remove('active');
            overlay.classList.remove('active');
        }

        // Refactorizado: Ahora usa ID para buscar el producto (M√°s seguro)
        function addToCart(productId, sizeSelectId) {
            // Usamos == para permitir coincidencia entre string (HTML) y number (JSON)
            const product = products.find(p => p.id == productId);
            if (!product) return;

            const sizeSelect = document.getElementById(sizeSelectId);
            const size = sizeSelect.value;
            
            if (!size) {
                showToast("‚ö†Ô∏è Por favor, selecciona una talla.");
                return;
            }
            
            // Obtener color seleccionado
            const colorEl = document.querySelector(`#color-wrap-${productId} .selected`);
            const color = colorEl ? colorEl.dataset.color : Object.keys(product.stock)[0];

            // Stock check
            const availableStock = (product.stock[color] && product.stock[color][size]) || 0;
            // Usamos product.id para asegurar que el tipo de dato (n√∫mero/texto) coincida siempre
            const inCartCount = cart.filter(item => item.productId === product.id && item.size === size && item.color === color).length;

            if (inCartCount >= availableStock) {
                showToast("No hay m√°s stock para esta talla.");
                return;
            }
            
            // Guardamos referencia al ID para consistencia
            cart.push({
                productId: product.id,
                name: product.name,
                price: product.price,
                image: product.images[0],
                size: size,
                color: color
            });

            saveCart();
            renderCart();
            showToast("Producto a√±adido al carrito");
            openCart(); // Abrir el carrito autom√°ticamente para confirmar visualmente
        }

        function removeFromCart(index) {
            cart.splice(index, 1);
            saveCart();
            renderCart();
        }

        function renderCart() {
            cartCountEl.innerText = cart.length;
            
            if (cart.length === 0) {
                cartItemsContainer.innerHTML = '<p class="text-center" style="margin-top: 50px; color: #999;">Tu carrito est√° vac√≠o.</p>';
                cartTotalEl.innerText = '$0.00';
                return;
            }

            let total = 0;
            cartItemsContainer.innerHTML = '';

            cart.forEach((item, index) => {
                total += item.price;
                const itemEl = document.createElement('div');
                itemEl.classList.add('cart-item');
                itemEl.innerHTML = `
                    <img src="${item.image}" alt="${item.name}">
                    <div class="cart-item-details">
                        <h4 style="font-size: 0.9rem; margin-bottom: 5px;">${item.name} <br><span style="font-weight:normal; font-size:0.8em; color:#666;">${item.color} | Talla: ${item.size}</span></h4>
                        <p style="color: var(--color-accent); font-weight: 500;">${formatCurrency(item.price)}</p>
                        <span class="cart-item-remove" onclick="removeFromCart(${index})" role="button" tabindex="0">Eliminar</span>
                    </div>
                `;
                cartItemsContainer.appendChild(itemEl);
            });

            cartTotalEl.innerText = formatCurrency(total);
        }

        function showToast(message) {
            const toast = document.getElementById("toast");
            toast.innerText = message;
            toast.classList.add("show");
            setTimeout(() => { toast.classList.remove("show"); }, 3000);
        }

        // Persistencia de datos (LocalStorage)
        function saveCart() {
            localStorage.setItem(CONFIG.STORAGE.CART, JSON.stringify(cart));
        }

        // Cargar carrito al iniciar
        document.addEventListener('DOMContentLoaded', () => {
            const savedCart = localStorage.getItem(CONFIG.STORAGE.CART);
            if (savedCart) {
                cart = JSON.parse(savedCart);
                renderCart();
            }
            initStore(); // Cargar productos
        });

        /* --- 4. GESTI√ìN DE PRODUCTOS E INVENTARIO (DATA) --- */
        const defaultProducts = [
            { id: 1, name: 'Sandalia Terracota', category: 'sandalias', price: 89.00, images: ['https://images.unsplash.com/photo-1595950653106-6c9ebd614d3a?q=80&w=800&auto=format&fit=crop'], stock: { 'Terracota': {'35':0, '36':5, '37':8, '38':2, '39':0, '40':0} } },
            { id: 2, name: 'Stiletto Noir', category: 'stilettos', price: 120.00, images: ['https://images.unsplash.com/photo-1566150905458-1bf1fc113f0d?q=80&w=800&auto=format&fit=crop'], stock: { 'Negro': {'35':10, '36':10, '37':10, '38':10, '39':10, '40':10} } },
            { id: 3, name: 'Tenis Chunky', category: 'tenis', price: 95.00, images: ['https://images.unsplash.com/photo-1551107696-a4b0c5a0d9a2?q=80&w=800&auto=format&fit=crop'], stock: { 'Blanco': {'35':2, '36':5, '37':4, '38':5, '39':3, '40':0}, 'Negro': {'35':1, '36':2, '37':0, '38':1, '39':0, '40':0} } }
        ];

        let products = [];

        function initStore() {
            // Si Firebase est√° activo, usarlo en lugar de LocalStorage
            if (db) {
                db.collection('products').onSnapshot((snapshot) => {
                    products = [];
                    snapshot.forEach((doc) => {
                        products.push({ id: doc.id, ...doc.data() });
                    });
                    renderShop();
                    if(document.getElementById('adminDashboard').classList.contains('active')) renderAdminList();
                });
                return;
            }

            const stored = localStorage.getItem(CONFIG.STORAGE.PRODUCTS);
            let validData = false;

            if (stored) {
                try {
                    products = JSON.parse(stored);
                    // Validaci√≥n: Si los productos guardados no tienen 'stock' (versi√≥n vieja), reseteamos
                    if (Array.isArray(products) && products.length > 0 && products[0].images) {
                        validData = true;
                    }
                } catch(e) { console.error("Error datos locales", e); }
            }
            
            if (!validData) {
                products = defaultProducts;
                localStorage.setItem(CONFIG.STORAGE.PRODUCTS, JSON.stringify(products));
            }
            renderShop();
        }

        function filterProducts(category) {
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            renderShop(category);
        }

        function renderShop(filter = 'all') {
            const grid = document.querySelector('.products-grid');
            grid.innerHTML = '';
            
            const filtered = filter === 'all' ? products : products.filter(p => p.category === filter);

            filtered.forEach(p => {
                // Calcular stock total sumando todos los colores
                let totalStock = 0;
                const colors = Object.keys(p.stock);
                colors.forEach(c => {
                    totalStock += Object.values(p.stock[c]).reduce((a,b)=>a+b, 0);
                });

                const card = document.createElement('div');
                card.className = 'product-card reveal active';
                if (totalStock === 0) {
                    card.classList.add('out-of-stock');
                }

                // Generar HTML de colores
                let colorHtml = '';
                if (colors.length > 0) {
                    colorHtml = `<div class="color-select-wrap" id="color-wrap-${p.id}">`;
                    colors.forEach((c, idx) => {
                        colorHtml += `<span class="color-option ${idx===0?'selected':''}" onclick="selectColor('${p.id}', '${c}', this)" data-color="${c}">${c}</span>`;
                    });
                    colorHtml += `</div>`;
                }

                // Generar HTML de im√°genes (Galer√≠a)
                let imagesHtml = `<img src="${p.images[0]}" id="img-${p.id}" alt="${p.name}">`;
                let dotsHtml = '';
                if(p.images.length > 1) {
                    dotsHtml = '<div class="gallery-nav">';
                    p.images.forEach((img, idx) => {
                        dotsHtml += `<div class="gallery-dot ${idx===0?'active':''}" onclick="changeImage('${p.id}', '${img}', this)"></div>`;
                    });
                    dotsHtml += '</div>';
                }

                card.innerHTML = `
                    <div class="product-image">
                        ${totalStock === 0 ? '<div class="sold-out-badge">Agotado</div>' : ''}
                        ${imagesHtml}
                        ${dotsHtml}
                    </div>
                    <div class="product-info">
                        <h3 class="product-name">${p.name}</h3>
                        <p class="product-price">${formatCurrency(p.price)}</p>
                        ${colorHtml}
                        <select class="size-select" id="size-${p.id}" ${totalStock === 0 ? 'disabled' : ''}>
                            <!-- Se llena din√°micamente -->
                        </select>
                        <button class="add-to-cart-btn" onclick="addToCart('${p.id}', 'size-${p.id}')" ${totalStock === 0 ? 'disabled' : ''}>
                            ${totalStock === 0 ? 'Agotado' : 'A√±adir al Carrito'}
                        </button>
                    </div>
                `;
                grid.appendChild(card);
                
                // Inicializar tallas del primer color
                if(colors.length > 0) updateSizes(p.id, colors[0]);
            });
        }

        function changeImage(pid, src, dot) {
            document.getElementById(`img-${pid}`).src = src;
            dot.parentElement.querySelectorAll('.gallery-dot').forEach(d => d.classList.remove('active'));
            dot.classList.add('active');
        }

        function selectColor(pid, color, btn) {
            const wrap = document.getElementById(`color-wrap-${pid}`);
            wrap.querySelectorAll('.color-option').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            updateSizes(pid, color);
        }

        function updateSizes(pid, color) {
            const product = products.find(p => p.id == pid);
            const select = document.getElementById(`size-${pid}`);
            const stockData = product.stock[color];
            
            let html = '<option value="">Talla</option>';
            for (const [size, qty] of Object.entries(stockData)) {
                if (qty > 0) {
                    html += `<option value="${size}">${size}</option>`;
                } else {
                    html += `<option value="${size}" disabled>${size} (Agotado)</option>`;
                }
            }
            select.innerHTML = html;
        }

        /* --- 5. PANEL DE ADMINISTRADOR (ADMIN LOGIC) --- */
        function openAdminLogin() {
            document.getElementById('adminLoginModal').classList.add('active');
            document.getElementById('overlay').classList.add('active');
        }
        function closeAdminLogin() {
            document.getElementById('adminLoginModal').classList.remove('active');
            document.getElementById('overlay').classList.remove('active');
        }
        function checkAdminLogin() {
            const pass = document.getElementById('adminPassword').value;
            const currentPass = localStorage.getItem(CONFIG.STORAGE.ADMIN) || 'admin123';
            
            if(pass === currentPass) {
                closeAdminLogin();
                document.getElementById('adminDashboard').classList.add('active');
                renderAdminList();
            } else {
                alert('Contrase√±a incorrecta');
            }
        }
        function closeAdminDashboard() {
            document.getElementById('adminDashboard').classList.remove('active');
        }

        function togglePasswordChange() {
            document.getElementById('passwordChangeForm').classList.toggle('active');
        }

        function saveNewPassword() {
            const newPass = document.getElementById('newAdminPass').value;
            if(newPass.length < 4) {
                showToast("‚ö†Ô∏è La contrase√±a debe tener al menos 4 caracteres.");
                return;
            }
            localStorage.setItem(CONFIG.STORAGE.ADMIN, newPass);
            showToast("‚úÖ ¬°Contrase√±a actualizada con √©xito!");
            document.getElementById('newAdminPass').value = '';
            togglePasswordChange();
        }

        function toggleHelp() {
            document.getElementById('productForm').classList.remove('active');
            document.getElementById('passwordChangeForm').classList.remove('active');
            document.getElementById('adminHelp').classList.toggle('active');
        }

        function downloadBackup() {
            const dataStr = localStorage.getItem(CONFIG.STORAGE.PRODUCTS);
            if (!dataStr) {
                showToast("No hay productos para respaldar.");
                return;
            }
            const data = JSON.stringify(JSON.parse(dataStr), null, 2); // Pretty print
            const blob = new Blob([data], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            
            const date = new Date();
            const dateStr = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;
            a.style.display = 'none';
            a.href = url;
            a.download = `banttu_backup_${dateStr}.json`;
            
            document.body.appendChild(a);
            a.click();
            
            URL.revokeObjectURL(url);
            document.body.removeChild(a);
            showToast("‚úÖ Respaldo descargado.");
        }

        function triggerRestore() {
            document.getElementById('restoreInput').click();
        }

        function restoreBackup(input) {
            const file = input.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    // Validaci√≥n b√°sica: debe ser un array
                    if (Array.isArray(data)) {
                        if(confirm(`¬øEst√°s seguro? Esto reemplazar√° tu inventario actual con ${data.length} productos del respaldo.`)) {
                            products = data;
                            localStorage.setItem(CONFIG.STORAGE.PRODUCTS, JSON.stringify(products));
                            renderShop();
                            renderAdminList();
                            showToast("‚úÖ Inventario restaurado con √©xito.");
                        }
                    } else {
                        showToast("‚ö†Ô∏è El archivo no tiene un formato v√°lido.");
                    }
                } catch (err) {
                    showToast("‚ö†Ô∏è Error al leer el archivo de respaldo.");
                }
                input.value = ''; // Resetear para permitir cargar el mismo archivo si es necesario
            };
            reader.readAsText(file);
        }

        function exportForCode() {
            const code = `const defaultProducts = ${JSON.stringify(products, null, 4)};`;
            navigator.clipboard.writeText(code).then(() => {
                showToast("‚úÖ ¬°C√≥digo copiado! P√©galo en tu archivo index.html");
                alert("He copiado tus productos actuales al portapapeles.\n\nPASO SIGUIENTE:\n1. Abre tu archivo index.html en el bloc de notas.\n2. Busca la l√≠nea 'const defaultProducts = ...'\n3. Borra esa lista y pega lo que acabas de copiar.\n4. Guarda y sube el archivo a Netlify.\n\n¬°As√≠ tus clientes ver√°n los cambios!");
            }).catch(err => {
                showToast("‚ùå Error al copiar. Intenta de nuevo.");
            });
        }

        function renderAdminList() {
            const list = document.getElementById('adminProductList');
            list.innerHTML = '';
            products.forEach(p => {
                const item = document.createElement('div');
                item.className = 'product-list-item';
                item.innerHTML = `
                    <img src="${p.images[0]}">
                    <div class="product-list-info">
                        <strong>${p.name}</strong><br>
                        <small>${p.category}</small><br>
                        ${formatCurrency(p.price)}
                    </div>
                    <div class="admin-actions">
                        <button class="btn btn-sm btn-outline" onclick="editProduct(${p.id})"><i class="fas fa-edit"></i></button>
                        <button class="btn btn-sm btn-danger" onclick="deleteProduct(${p.id})"><i class="fas fa-trash"></i></button>
                    </div>
                `;
                list.appendChild(item);
            });
        }

        function showAddForm() {
            document.getElementById('productForm').classList.add('active');
            document.getElementById('editId').value = '';
            document.getElementById('editName').value = '';
            document.getElementById('editPrice').value = '';
            document.getElementById('editImages').value = '';
            document.getElementById('editImageFile').value = '';
            document.getElementById('editCategory').value = 'sandalias';
            
            document.getElementById('stockContainer').innerHTML = '';
            document.getElementById('currentImagesContainer').innerHTML = '';
            // Agregar un color por defecto
            adminAddColor('Est√°ndar');
        }

        function adminAddColor(colorName = '') {
            const name = colorName || document.getElementById('newColorInput').value;
            if(!name) return alert("Escribe un nombre de color");
            
            const container = document.getElementById('stockContainer');
            const div = document.createElement('div');
            div.className = 'stock-color-group';
            div.dataset.color = name;
            
            let html = `<strong>${name}</strong> <button class="btn btn-sm btn-danger" onclick="this.parentElement.remove()" style="float:right">X</button><div class="sizes-grid">`;
            ['35','36','37','38','39','40'].forEach(size => {
                html += `
                    <div class="size-stock-item">
                        <label>T${size}</label>
                        <input type="number" class="stock-input" data-size="${size}" min="0" value="0">
                    </div>`;
            });
            html += '</div>';
            div.innerHTML = html;
            container.appendChild(div);
            document.getElementById('newColorInput').value = '';
        }

        function cancelEdit() { document.getElementById('productForm').classList.remove('active'); }
        
        function editProduct(id) {
            const p = products.find(x => x.id === id);
            document.getElementById('productForm').classList.add('active');
            document.getElementById('editId').value = p.id;
            document.getElementById('editName').value = p.name;
            document.getElementById('editCategory').value = p.category || 'sandalias';
            document.getElementById('editPrice').value = p.price;
            document.getElementById('editImages').value = ''; // Limpiar input de URLs nuevas
            document.getElementById('editImageFile').value = '';
            
            // Renderizar im√°genes actuales
            const imgContainer = document.getElementById('currentImagesContainer');
            imgContainer.innerHTML = '';
            p.images.forEach(imgSrc => {
                const div = document.createElement('div');
                div.className = 'image-preview-item';
                div.innerHTML = `<img src="${imgSrc}"><button class="remove-btn" onclick="this.parentElement.remove()">X</button>`;
                imgContainer.appendChild(div);
            });

            const container = document.getElementById('stockContainer');
            container.innerHTML = '';
            
            Object.keys(p.stock).forEach(color => {
                const div = document.createElement('div');
                div.className = 'stock-color-group';
                div.dataset.color = color;
                let html = `<strong>${color}</strong> <button class="btn btn-sm btn-danger" onclick="this.parentElement.remove()" style="float:right">X</button><div class="sizes-grid">`;
                ['35','36','37','38','39','40'].forEach(size => {
                    const val = p.stock[color][size] || 0;
                    html += `<div class="size-stock-item"><label>T${size}</label><input type="number" class="stock-input" data-size="${size}" min="0" value="${val}"></div>`;
                });
                html += '</div>';
                div.innerHTML = html;
                container.appendChild(div);
            });
        }

        async function saveProduct() {
            const id = document.getElementById('editId').value;
            const name = document.getElementById('editName').value;
            const category = document.getElementById('editCategory').value;
            const price = parseFloat(document.getElementById('editPrice').value);
            const imagesStr = document.getElementById('editImages').value;
            const imageFiles = document.getElementById('editImageFile').files;
            
            // Recolectar stock complejo
            const newStock = {};
            document.querySelectorAll('.stock-color-group').forEach(group => {
                const color = group.dataset.color;
                newStock[color] = {};
                group.querySelectorAll('.stock-input').forEach(input => {
                    newStock[color][input.dataset.size] = parseInt(input.value) || 0;
                });
            });

            try {
                // 1. Recolectar im√°genes que quedaron en el contenedor (las que no se borraron)
                let finalImagesList = Array.from(document.querySelectorAll('#currentImagesContainer img')).map(img => img.src);

                // 2. Procesar nuevas URLs
                if(imagesStr) {
                    const urls = imagesStr.split(',').map(s => s.trim()).filter(s => s);
                    finalImagesList = [...finalImagesList, ...urls];
                }

                // 3. Procesar nuevos archivos (M√∫ltiples)
                if (imageFiles.length > 0) {
                    const promises = Array.from(imageFiles).map(file => compressImage(file));
                    const compressedImages = await Promise.all(promises);
                    finalImagesList = [...finalImagesList, ...compressedImages];
                    if (IMGBB_API_KEY && IMGBB_API_KEY !== "TU_API_KEY_DE_IMGBB_AQUI") {
                        // Subir a ImgBB (Gratis y sin tarjeta)
                        showToast("Subiendo im√°genes a ImgBB... ‚è≥");
                        
                        const uploadPromises = Array.from(imageFiles).map(async (file) => {
                            const formData = new FormData();
                            formData.append('image', file);
                            const response = await fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_API_KEY}`, {
                                method: 'POST',
                                body: formData
                            });
                            const data = await response.json();
                            return data.data.url;
                        });
                        
                        try {
                            const uploadedUrls = await Promise.all(uploadPromises);
                            finalImagesList = [...finalImagesList, ...uploadedUrls];
                        } catch(err) {
                            console.error(err);
                            alert("Error subiendo a ImgBB. Verifica tu API Key.");
                            return; // Detener guardado
                        }
                    } else {
                        // Fallback Local (Base64) - Solo si no hay internet o config
                        const promises = Array.from(imageFiles).map(file => compressImage(file));
                        const compressedImages = await Promise.all(promises);
                        finalImagesList = [...finalImagesList, ...compressedImages];
                    }
                }
                
                // Si no hay im√°genes, poner placeholder
                if(finalImagesList.length === 0) finalImagesList = ['https://via.placeholder.com/300'];

                if(id) {
                    // Editar
                    const index = products.findIndex(x => x.id == id);
                    products[index] = { ...products[index], name, category, price, images: finalImagesList, stock: newStock };
                } else {
                    // Nuevo
                    const newId = products.length > 0 ? Math.max(...products.map(p => p.id)) + 1 : 1;
                    products.push({ id: newId, name, category, price, images: finalImagesList, stock: newStock });
                }
                
                if (db) {
                    // Guardar en Firebase
                    const docId = id ? String(id) : String(Date.now());
                    const productData = id 
                        ? { name, category, price, images: finalImagesList, stock: newStock }
                        : { id: docId, name, category, price, images: finalImagesList, stock: newStock };
                    
                    await db.collection('products').doc(docId).set(productData, { merge: true });
                    showToast('Guardado en la Nube ‚òÅÔ∏è');
                } else {
                    // Guardar Localmente
                    localStorage.setItem(CONFIG.STORAGE.PRODUCTS, JSON.stringify(products));
                    renderShop();
                    renderAdminList();
                    showToast('Guardado Localmente üíæ');
                }
                cancelEdit();
            } catch (e) {
                console.error(e);
                alert("‚ö†Ô∏è Error al guardar o procesar im√°genes.");
            }
        }

        // Helper para comprimir imagen
        function compressImage(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = new Image();
                    img.src = e.target.result;
                    img.onload = function() {
                        const canvas = document.createElement('canvas');
                        const MAX_WIDTH = 600;
                        const scaleSize = MAX_WIDTH / img.width;
                        canvas.width = MAX_WIDTH;
                        canvas.height = img.height * scaleSize;
                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                        resolve(canvas.toDataURL('image/jpeg', 0.7));
                    };
                    img.onerror = reject;
                };
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }

        function deleteProduct(id) {
            if(confirm('¬øSeguro que deseas eliminar este producto?')) {
                if (db) {
                    db.collection('products').doc(String(id)).delete()
                        .then(() => showToast('Eliminado de la Nube'))
                        .catch(e => alert("Error al eliminar"));
                } else {
                    products = products.filter(p => p.id !== id);
                    localStorage.setItem(CONFIG.STORAGE.PRODUCTS, JSON.stringify(products));
                    renderShop();
                    renderAdminList();
                    showToast('Producto eliminado');
                }
            }
        }

        /* --- 6. PROCESO DE PAGO (CHECKOUT) --- */
        function openCheckout() {
            if(cart.length === 0) return alert("El carrito est√° vac√≠o");
            closeCart();
            checkoutModal.classList.add('active');
            overlay.classList.add('active'); // Mantener overlay
        }

        function closeModal() {
            checkoutModal.classList.remove('active');
            overlay.classList.remove('active');
        }

        function togglePaymentMethod(method) {
            // Ocultar todos los detalles
            document.querySelectorAll('.payment-details').forEach(el => el.classList.remove('active'));
            // Mostrar el seleccionado
            document.getElementById('details-' + method).classList.add('active');
            
            // Gestionar 'required' para inputs ocultos
            document.querySelectorAll('.payment-details input').forEach(input => input.required = false);
            document.querySelectorAll(`#details-${method} input`).forEach(input => input.required = true);
        }

        async function processPayment(e) {
            e.preventDefault();
            const btn = document.getElementById('payBtn');
            const originalText = btn.innerText;
            
            // 1. Capturar datos del formulario
            const name = document.getElementById('customerName').value;
            const address = document.getElementById('customerAddress').value;
            
            // 2. Detectar m√©todo de pago y detalles
            let paymentMethod = '';
            let paymentDetails = '';
            
            if(document.getElementById('pm-nequi').checked) {
                paymentMethod = 'Transferencia Nequi';
                const nequiCode = document.getElementById('nequiPhoneNumber').value;
                const hasReceipt = document.getElementById('nequiReceipt').files.length > 0;
                paymentDetails = `Comprobante: ${nequiCode || '3157243588'}`;
                if(hasReceipt) paymentDetails += " (Imagen adjunta en chat)";
            } else {
                paymentMethod = 'Contra Entrega';
                paymentDetails = 'Cobrar en efectivo al entregar';
            }
            
            // Simulaci√≥n de proceso de pago
            btn.innerHTML = '<div class="loader"></div> Procesando...';
            btn.disabled = true;

            await delay(500);

            // DECREMENT STOCK
            cart.forEach(cartItem => {
                // Refactorizado: B√∫squeda por ID para mayor precisi√≥n
                const productIndex = products.findIndex(p => p.id === cartItem.productId);
                if (productIndex !== -1) {
                    // Buscar en qu√© color est√° y restar
                    // Nota: En un sistema real esto es m√°s complejo, aqu√≠ asumimos que el usuario
                    // seleccion√≥ un color espec√≠fico. Como el carrito guarda el color:
                    if (products[productIndex].stock[cartItem.color] && products[productIndex].stock[cartItem.color][cartItem.size] > 0) {
                        products[productIndex].stock[cartItem.color][cartItem.size]--;
                    }
                }
            });
            if (db) {
                // Actualizar stock en nube (simple, sin transacciones complejas por ahora)
                products.forEach(p => db.collection('products').doc(String(p.id)).set(p));
            } else {
                localStorage.setItem(CONFIG.STORAGE.PRODUCTS, JSON.stringify(products));
            }
            renderShop(); // Re-render shop to show updated stock

            // 3. Construir mensaje de WhatsApp para la due√±a
            let message = `*HOLA BANTT√ö, NUEVO PEDIDO WEB* üõçÔ∏è%0A%0A`;
            message += `üë§ *Cliente:* ${encodeURIComponent(name)}%0A`;
            message += `üìç *Direcci√≥n:* ${encodeURIComponent(address)}%0A`;
            message += `üí≥ *M√©todo:* ${paymentMethod}%0A`;
            message += `üìù *Detalle Pago:* ${encodeURIComponent(paymentDetails)}%0A%0A`;
            message += `*RESUMEN DE COMPRA:*%0A`;
            
            let total = 0;
            cart.forEach(item => {
                message += `‚ñ™Ô∏è ${item.name} (${item.color}, T${item.size}) - ${formatCurrency(item.price)}%0A`;
                total += item.price;
            });
            
            message += `%0Aüí∞ *TOTAL A PAGAR: ${formatCurrency(total)}*`;

            // 4. Enviar a WhatsApp y limpiar
            // Usar location.href para evitar bloqueo de popups en m√≥viles
            window.location.href = `https://wa.me/${CONFIG.WHATSAPP}?text=${message}`;
            
            cart = [];
            saveCart();
            renderCart();
            closeModal();
            // Resetear bot√≥n
            btn.innerText = originalText;
            btn.style.backgroundColor = '';
            btn.style.borderColor = '';
            btn.disabled = false;
            document.getElementById('paymentForm').reset();
        }

        function checkoutWhatsApp() {
            if(cart.length === 0) return;
            
            // Intentar capturar datos del formulario si el usuario los llen√≥
            const name = document.getElementById('customerName').value || "Cliente Web";
            const address = document.getElementById('customerAddress').value || "Por coordinar";

            let message = `Hola BANTT√ö, soy *${encodeURIComponent(name)}*.%0A`;
            message += `Me gustar√≠a ordenar lo siguiente para env√≠o a: *${encodeURIComponent(address)}*%0A%0A`;
            
            let total = 0;
            
            cart.forEach(item => {
                message += `- ${item.name} (${item.color}, T${item.size}) - ${formatCurrency(item.price)}%0A`;
                total += item.price;
            });
            
            message += `%0ATotal: ${formatCurrency(total)}`;
            
            window.location.href = `https://wa.me/${CONFIG.WHATSAPP}?text=${message}`;
        }
    </script>
</body>
</html>
